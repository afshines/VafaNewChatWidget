(function(p,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(p=typeof globalThis<"u"?globalThis:p||self,n(p.VafaChatWidget={},p.Vue))})(this,function(p,n){"use strict";const m=Object.create(null);m.open="0",m.close="1",m.ping="2",m.pong="3",m.message="4",m.upgrade="5",m.noop="6";const T=Object.create(null);Object.keys(m).forEach(s=>{T[m[s]]=s});const A={type:"error",data:"parser error"},X=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",G=typeof ArrayBuffer=="function",Z=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,O=({type:s,data:e},t,i)=>X&&e instanceof Blob?t?i(e):$(e,i):G&&(e instanceof ArrayBuffer||Z(e))?t?i(e):$(new Blob([e]),i):i(m[s]+(e||"")),$=(s,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+(i||""))},t.readAsDataURL(s)};function ee(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let R;function ve(s,e){if(X&&s.data instanceof Blob)return s.data.arrayBuffer().then(ee).then(e);if(G&&(s.data instanceof ArrayBuffer||Z(s.data)))return e(ee(s.data));O(s,!1,t=>{R||(R=new TextEncoder),e(R.encode(t))})}const te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<te.length;s++)b[te.charCodeAt(s)]=s;const ye=s=>{let e=s.length*.75,t=s.length,i,r=0,o,c,a,h;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const y=new ArrayBuffer(e),u=new Uint8Array(y);for(i=0;i<t;i+=4)o=b[s.charCodeAt(i)],c=b[s.charCodeAt(i+1)],a=b[s.charCodeAt(i+2)],h=b[s.charCodeAt(i+3)],u[r++]=o<<2|c>>4,u[r++]=(c&15)<<4|a>>2,u[r++]=(a&3)<<6|h&63;return y},we=typeof ArrayBuffer=="function",I=(s,e)=>{if(typeof s!="string")return{type:"message",data:se(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:ke(s.substring(1),e)}:T[t]?s.length>1?{type:T[t],data:s.substring(1)}:{type:T[t]}:A},ke=(s,e)=>{if(we){const t=ye(s);return se(t,e)}else return{base64:!0,data:s}},se=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},ie="",xe=(s,e)=>{const t=s.length,i=new Array(t);let r=0;s.forEach((o,c)=>{O(o,!1,a=>{i[c]=a,++r===t&&e(i.join(ie))})})},be=(s,e)=>{const t=s.split(ie),i=[];for(let r=0;r<t.length;r++){const o=I(t[r],e);if(i.push(o),o.type==="error")break}return i};function _e(){return new TransformStream({transform(s,e){ve(s,t=>{const i=t.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);const o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let D;function S(s){return s.reduce((e,t)=>e+t.length,0)}function C(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let i=0;for(let r=0;r<e;r++)t[r]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),t}function Ee(s,e){D||(D=new TextDecoder);const t=[];let i=0,r=-1,o=!1;return new TransformStream({transform(c,a){for(t.push(c);;){if(i===0){if(S(t)<1)break;const h=C(t,1);o=(h[0]&128)===128,r=h[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(S(t)<2)break;const h=C(t,2);r=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),i=3}else if(i===2){if(S(t)<8)break;const h=C(t,8),y=new DataView(h.buffer,h.byteOffset,h.length),u=y.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(A);break}r=u*Math.pow(2,32)+y.getUint32(4),i=3}else{if(S(t)<r)break;const h=C(t,r);a.enqueue(I(o?h:D.decode(h),e)),i=0}if(r===0||r>s){a.enqueue(A);break}}}})}const ne=4;function d(s){if(s)return Te(s)}function Te(s){for(var e in d.prototype)s[e]=d.prototype[e];return s}d.prototype.on=d.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this},d.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,r=0;r<t.length;r++)if(i=t[r],i===e||i.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this},d.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,r=t.length;i<r;++i)t[i].apply(this,e)}return this},d.prototype.emitReserved=d.prototype.emit,d.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]},d.prototype.hasListeners=function(s){return!!this.listeners(s).length};const B=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),f=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Se="arraybuffer";function ys(){}function re(s,...e){return e.reduce((t,i)=>(s.hasOwnProperty(i)&&(t[i]=s[i]),t),{})}const Ce=f.setTimeout,Be=f.clearTimeout;function N(s,e){e.useNativeTimers?(s.setTimeoutFn=Ce.bind(f),s.clearTimeoutFn=Be.bind(f)):(s.setTimeoutFn=f.setTimeout.bind(f),s.clearTimeoutFn=f.clearTimeout.bind(f))}const Ne=1.33;function Le(s){return typeof s=="string"?Ve(s):Math.ceil((s.byteLength||s.size)*Ne)}function Ve(s){let e=0,t=0;for(let i=0,r=s.length;i<r;i++)e=s.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}function oe(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Me(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function Ae(s){let e={},t=s.split("&");for(let i=0,r=t.length;i<r;i++){let o=t[i].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}class Oe extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class q extends d{constructor(e){super(),this.writable=!1,N(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,i){return super.emitReserved("error",new Oe(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=I(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Me(e);return t.length?"?"+t:""}}class Re extends q{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};be(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,xe(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=oe()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let ce=!1;try{ce=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Ie=ce;function De(){}class qe extends Re{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let i=location.port;i||(i=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}class v extends d{constructor(e,t,i){super(),this.createRequest=e,N(this,i),this._opts=i,this._method=i.method||"GET",this._uri=t,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const t=re(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(t);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=v.requestsCount++,v.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=De,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete v.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(v.requestsCount=0,v.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ae);else if(typeof addEventListener=="function"){const s="onpagehide"in f?"pagehide":"unload";addEventListener(s,ae,!1)}}function ae(){for(let s in v.requests)v.requests.hasOwnProperty(s)&&v.requests[s].abort()}const ze=function(){const s=le({xdomain:!1});return s&&s.responseType!==null}();class Pe extends qe{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=ze&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new v(le,this.uri(),e)}}function le(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Ie))return new XMLHttpRequest}catch{}if(!e)try{return new f[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const he=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ue extends q{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,i=he?{}:re(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],r=t===e.length-1;O(i,this.supportsBinary,o=>{try{this.doWrite(i,o)}catch{}r&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=oe()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const z=f.WebSocket||f.MozWebSocket;class Qe extends Ue{createSocket(e,t,i){return he?new z(e,t,i):t?new z(e,t):new z(e)}doWrite(e,t){this.ws.send(t)}}class Fe extends q{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Ee(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),r=_e();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const o=()=>{i.read().then(({done:a,value:h})=>{a||(this.onPacket(h),o())}).catch(a=>{})};o();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],r=t===e.length-1;this._writer.write(i).then(()=>{r&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Ke={websocket:Qe,webtransport:Fe,polling:Pe},je=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,He=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function P(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),i=s.indexOf("]");t!=-1&&i!=-1&&(s=s.substring(0,t)+s.substring(t,i).replace(/:/g,";")+s.substring(i,s.length));let r=je.exec(s||""),o={},c=14;for(;c--;)o[He[c]]=r[c]||"";return t!=-1&&i!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=We(o,o.path),o.queryKey=Ye(o,o.query),o}function We(s,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Ye(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,o){r&&(t[r]=o)}),t}const U=typeof addEventListener=="function"&&typeof removeEventListener=="function",L=[];U&&addEventListener("offline",()=>{L.forEach(s=>s())},!1);class w extends d{constructor(e,t){if(super(),this.binaryType=Se,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const i=P(e);t.hostname=i.host,t.secure=i.protocol==="https"||i.protocol==="wss",t.port=i.port,i.query&&(t.query=i.query)}else t.host&&(t.hostname=P(t.host).host);N(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(i=>{const r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Ae(this.opts.query)),U&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},L.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=ne,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&w.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",w.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(t+=Le(r)),i>0&&t>this._maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,B(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,i){return this._sendPacket("message",e,t,i),this}send(e,t,i){return this._sendPacket("message",e,t,i),this}_sendPacket(e,t,i,r){if(typeof t=="function"&&(r=t,t=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const o={type:e,data:t,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(w.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),U&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=L.indexOf(this._offlineEventListener);i!==-1&&L.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}w.protocol=ne;class Je extends w{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),i=!1;w.priorWebsocketSuccess=!1;const r=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",k=>{if(!i)if(k.type==="pong"&&k.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;w.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const E=new Error("probe error");E.transport=t.name,this.emitReserved("upgradeError",E)}}))};function o(){i||(i=!0,u(),t.close(),t=null)}const c=k=>{const E=new Error("probe error: "+k);E.transport=t.name,o(),this.emitReserved("upgradeError",E)};function a(){c("transport closed")}function h(){c("socket closed")}function y(k){t&&k.name!==t.name&&o()}const u=()=>{t.removeListener("open",r),t.removeListener("error",c),t.removeListener("close",a),this.off("close",h),this.off("upgrading",y)};t.once("open",r),t.once("error",c),t.once("close",a),this.once("close",h),this.once("upgrading",y),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}}let Xe=class extends Je{constructor(e,t={}){const i=typeof e=="object"?e:t;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>Ke[r]).filter(r=>!!r)),super(e,i)}};function Ge(s,e="",t){let i=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),i=P(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+e,i.href=i.protocol+"://"+o+(t&&t.port===i.port?"":":"+i.port),i}const Ze=typeof ArrayBuffer=="function",$e=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,de=Object.prototype.toString,et=typeof Blob=="function"||typeof Blob<"u"&&de.call(Blob)==="[object BlobConstructor]",tt=typeof File=="function"||typeof File<"u"&&de.call(File)==="[object FileConstructor]";function Q(s){return Ze&&(s instanceof ArrayBuffer||$e(s))||et&&s instanceof Blob||tt&&s instanceof File}function V(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,i=s.length;t<i;t++)if(V(s[t]))return!0;return!1}if(Q(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return V(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&V(s[t]))return!0;return!1}function st(s){const e=[],t=s.data,i=s;return i.data=F(t,e),i.attachments=e.length,{packet:i,buffers:e}}function F(s,e){if(!s)return s;if(Q(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let i=0;i<s.length;i++)t[i]=F(s[i],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=F(s[i],e));return t}return s}function it(s,e){return s.data=K(s.data,e),delete s.attachments,s}function K(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=K(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=K(s[t],e));return s}const nt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],rt=5;var l;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(l||(l={}));class ot{constructor(e){this.replacer=e}encode(e){return(e.type===l.EVENT||e.type===l.ACK)&&V(e)?this.encodeAsBinary({type:e.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===l.BINARY_EVENT||e.type===l.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=st(e),i=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(i),r}}function fe(s){return Object.prototype.toString.call(s)==="[object Object]"}class j extends d{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const i=t.type===l.BINARY_EVENT;i||t.type===l.BINARY_ACK?(t.type=i?l.EVENT:l.ACK,this.reconstructor=new ct(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Q(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(l[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===l.BINARY_EVENT||i.type===l.BINARY_ACK){const o=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const c=e.substring(o,t);if(c!=Number(c)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(c)}if(e.charAt(t+1)==="/"){const o=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(o,t)}else i.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const o=t+1;for(;++t;){const c=e.charAt(t);if(c==null||Number(c)!=c){--t;break}if(t===e.length)break}i.id=Number(e.substring(o,t+1))}if(e.charAt(++t)){const o=this.tryParse(e.substr(t));if(j.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case l.CONNECT:return fe(t);case l.DISCONNECT:return t===void 0;case l.CONNECT_ERROR:return typeof t=="string"||fe(t);case l.EVENT:case l.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&nt.indexOf(t[0])===-1);case l.ACK:case l.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ct{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=it(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const at=Object.freeze(Object.defineProperty({__proto__:null,Decoder:j,Encoder:ot,get PacketType(){return l},protocol:rt},Symbol.toStringTag,{value:"Module"}));function g(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const lt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ue extends d{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[g(e,"open",this.onopen.bind(this)),g(e,"packet",this.onpacket.bind(this)),g(e,"error",this.onerror.bind(this)),g(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var i,r,o;if(lt.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const c={type:l.EVENT,data:t};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const u=this.ids++,k=t.pop();this._registerAckCallback(u,k),c.id=u}const a=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,h=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!a||(h?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(e,t){var i;const r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},r),c=(...a)=>{this.io.clearTimeoutFn(o),t.apply(this,a)};c.withError=!0,this.acks[e]=c}emitWithAck(e,...t){return new Promise((i,r)=>{const o=(c,a)=>c?r(c):i(a);o.withError=!0,t.push(o),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...o)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:l.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case l.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case l.EVENT:case l.BINARY_EVENT:this.onevent(e);break;case l.ACK:case l.BINARY_ACK:this.onack(e);break;case l.DISCONNECT:this.ondisconnect();break;case l.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let i=!1;return function(...r){i||(i=!0,t.packet({type:l.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:l.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function x(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}x.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=(Math.floor(e*10)&1)==0?s-t:s+t}return Math.min(s,this.max)|0},x.prototype.reset=function(){this.attempts=0},x.prototype.setMin=function(s){this.ms=s},x.prototype.setMax=function(s){this.max=s},x.prototype.setJitter=function(s){this.jitter=s};class H extends d{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,N(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new x({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||at;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Xe(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=g(t,"open",function(){i.onopen(),e&&e()}),o=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},c=g(t,"error",o);if(this._timeout!==!1){const a=this._timeout,h=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),t.close()},a);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(r),this.subs.push(c),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(g(e,"ping",this.onping.bind(this)),g(e,"data",this.ondata.bind(this)),g(e,"error",this.onerror.bind(this)),g(e,"close",this.onclose.bind(this)),g(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){B(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new ue(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const _={};function M(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=Ge(s,e.path||"/socket.io"),i=t.source,r=t.id,o=t.path,c=_[r]&&o in _[r].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||c;let h;return a?h=new H(i,e):(_[r]||(_[r]=new H(i,e)),h=_[r]),t.query&&!e.query&&(e.query=t.queryKey),h.socket(t.path,e)}Object.assign(M,{Manager:H,Socket:ue,io:M,connect:M});const pe="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2027.2.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20736%20737.2'%20style='enable-background:new%200%200%20736%20737.2;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23FE0000;}%20%3c/style%3e%3cpath%20class='st0'%20d='M368,736c-96.1,0-192.1,0-289.3,0c-33.6,0-64.8-24.3-74.1-53.2C1.2,673.6,0,664.3,0,655C0,464.1,0,272,0,81%20C0,34.7,34.7,0,81,0c191,0,383.1,0,574,0c40.5,0,69.4,24.3,78.7,59C736,66,736,72.9,736,79.9c0,192.1,0,384.2,0,577.5%20c0,47.4-37,79.9-79.9,79.9C561.3,736,464.1,736,368,736z%20M162,532.4c0,33.6,0,61.3,0,89.1c0,5.8,1.2,8.1,8.1,8.1%20c32.4,0,64.8,0,97.2,0c6.9,0,8.1-2.3,8.1-8.1c0-53.2,0-106.5,0-158.6c0-22,19.7-37,37-37c38.2,1.2,76.4,0,114.6,0%20c8.1,0,16.2-1.2,24.3-2.3C521.9,412,574,350.7,575.2,277.8c0-54.4,0-107.6,0-162c0-5.8-1.2-6.9-8.1-6.9c-32.4,0-64.8,0-97.2,0%20c-6.9,0-8.1,1.2-8.1,8.1c0,52.1,0,104.2,0,156.2c0,20.8-12.7,40.5-40.5,40.5c-35.9-1.2-72.9,0-108.8,0c-18.5,0-35.9,2.3-53.2,9.3%20c-56.7,23.1-89.1,64.8-96.1,126.1C159.7,476.8,163.2,508.1,162,532.4z%20M275.4,202.5c0-30.1,0-60.2,0-90.3c0-4.6-1.2-6.9-6.9-6.9%20c-33.6,0-67.1,0-99.5,0c-4.6,0-6.9,1.2-6.9,6.9c0,60.2,0,120.4,0,179.4c0,5.8,1.2,6.9,6.9,6.9c33.6,0,66,0,99.5,0%20c5.8,0,6.9-1.2,6.9-6.9C274.3,262.7,275.4,232.6,275.4,202.5z%20M460.6,532.4c0,30.1,0,60.2,0,89.1c0,5.8,2.3,6.9,8.1,6.9%20c32.4,0,66,0,98.4,0c5.8,0,8.1-2.3,8.1-8.1c0-59,0-119.2,0-178.2c0-5.8-1.2-8.1-6.9-8.1c-33.6,0-66,0-99.5,0c-5.8,0-6.9,1.2-6.9,6.9%20C460.6,472.2,460.6,502.3,460.6,532.4z'/%3e%3c/svg%3e",ht=(s,e)=>{const t=s.__vccOpts||s;for(const[i,r]of e)t[i]=r;return t},dt={name:"ChatWidget",computed:{filteredCategories(){if(!this.knowledgeSearchQuery.trim())return this.knowledgeData;const s=this.knowledgeSearchQuery.trim().toLowerCase();return this.knowledgeData.filter(e=>e.title.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)?!0:e.questions.some(t=>t.question.toLowerCase().includes(s)||t.answer.toLowerCase().includes(s)))},filteredQuestions(){if(!this.selectedCategory)return[];if(!this.knowledgeSearchQuery.trim())return this.selectedCategory.questions;const s=this.knowledgeSearchQuery.trim().toLowerCase();return this.selectedCategory.questions.filter(e=>e.question.toLowerCase().includes(s)||e.answer.toLowerCase().includes(s))}},props:{welcomeTitle:{type:String,default:"خوش آمدید"},initialMessage:{type:String,default:"سلام! چطور میتونم کمکتون کنم؟"},defaultQuestion:{type:String,default:"چه خبر؟"},apiBaseUrl:{type:String,default:"https://api.vafaai.com"}},data(){return{isOpen:!1,hasInteracted:!1,isMaximize:!1,isMobile:!1,inputMessage:"",messages:[],socket:null,connectionStatus:"آنلاین",connectionColor:"green",sessionData:{id:null,initialized:!1},isThinking:!1,currentStreamingMessage:null,messageTimeout:null,socketUrl:this.apiBaseUrl,token:null,defaultQuestions:[this.defaultQuestion,"پیشنهاد سر آشپز چیست؟","نوشیدنی چی دارید؟"],showDefaultQuestions:!0,userId:null,currentTab:"home",knowledgeData:[],allQuestions:[],featuredQuestions:[{id:101,question:"برای دریافت فاکتور رسمی چه اطلاعاتی نیاز خواهد بود؟"},{id:303,question:"وفا با کدام زبان های برنامه نویسی سازگار است؟"},{id:301,question:"چطور می توانم در وفا ثبت نام کنم؟"},{id:401,question:"وفا راه حلی برای افزایش فروش"}],knowledgeView:"categories",knowledgeViewTitle:"پایگاه دانش",knowledgeSearchQuery:"",selectedCategory:null,selectedQuestion:null}},async mounted(){this.userId=localStorage.getItem("vafachat_user_id"),this.userId||(this.userId="user_"+Math.random().toString(36).substr(2,9),localStorage.setItem("vafachat_user_id",this.userId)),this.loadMessagesFromLocalStorage();const s=new URLSearchParams(window.location.search);this.token=this.$attrs.token||s.get("token")||null,await this.loadKnowledgeBaseData(),console.log("ChatWidget mounted with userId:",this.userId);const e=localStorage.getItem("lastSessionId");e&&(console.log("Found existing session ID:",e),this.sessionData.id=e),this.messages.push({content:this.initialMessage,isUser:!1,timestamp:new Date().toISOString()}),this.hasInteracted=localStorage.getItem("vafachat_interacted")==="true",setTimeout(()=>{this.initSocket()},500),this.setShakeTimer(),document.addEventListener("click",this.resetShakeTimer),document.addEventListener("mousemove",this.resetShakeTimer),document.addEventListener("keypress",this.resetShakeTimer),document.addEventListener("scroll",this.resetShakeTimer);const t=document.getElementById("vafachat-button");t&&t.addEventListener("animationend",()=>{this.hasInteracted=!0})},created(){this.checkMobile(),window.addEventListener("resize",this.checkMobile)},beforeUnmount(){document.removeEventListener("click",this.resetShakeTimer),document.removeEventListener("mousemove",this.resetShakeTimer),document.removeEventListener("keypress",this.resetShakeTimer),document.removeEventListener("scroll",this.resetShakeTimer),window.removeEventListener("resize",this.checkMobile),this.socket&&(this.socket.disconnect(),this.socket.removeAllListeners()),this.shakeTimer&&clearTimeout(this.shakeTimer),this.messageTimeout&&clearTimeout(this.messageTimeout)},methods:{async loadKnowledgeBaseData(){try{const s=await fetch("https://vafaai.com/widget/data/knowledgeBase.json");if(!s.ok)throw new Error(`Failed to fetch knowledge base data: ${s.status}`);const e=await s.json();this.knowledgeData=e.categories,this.allQuestions=[],this.knowledgeData.forEach(t=>{t.questions.forEach(i=>{this.allQuestions.push({...i,categoryId:t.id,categoryTitle:t.title})})})}catch(s){console.error("Error loading knowledge base data:",s)}},checkMobile(){this.isMobile=window.innerWidth<=768},getQuestionById(s){return this.allQuestions.find(t=>t.id===s)||{question:"سوال یافت نشد",answer:""}},navigateToQuestion(s){const e=this.getQuestionById(s);if(e){const t=this.knowledgeData.find(i=>i.id===e.categoryId);t&&(this.switchTab("knowledge"),this.selectedCategory=t,this.knowledgeView="questions",this.knowledgeViewTitle=t.title,this.$nextTick(()=>{this.selectQuestion(e)}))}},focusOnSearch(){this.$nextTick(()=>{this.$refs.homeSearchInput&&this.$refs.homeSearchInput.focus()})},showKnowledgeSearch(){this.switchTab("knowledge"),this.$nextTick(()=>{const s=document.querySelector(".knowledge-search-input");s&&s.focus()})},searchKnowledgeBase(){this.knowledgeView==="answer"&&(this.knowledgeView="categories")},selectCategory(s){this.selectedCategory=s,this.knowledgeView="questions",this.knowledgeViewTitle=s.title},selectQuestion(s){this.selectedQuestion=s,this.knowledgeView="answer"},goBackKnowledge(){this.knowledgeView==="questions"?(this.knowledgeView="categories",this.knowledgeViewTitle="پایگاه دانش"):this.knowledgeView==="answer"&&(this.knowledgeView="questions",this.knowledgeViewTitle=this.selectedCategory.title)},resetToCategories(){this.knowledgeView="categories",this.knowledgeViewTitle="پایگاه دانش"},switchTab(s){this.currentTab=s,this.isMaximize=!1,s==="messenger"&&this.$nextTick(()=>{this.scrollToBottom()}),s==="knowledge"&&(this.knowledgeView="categories",this.knowledgeViewTitle="پایگاه دانش",this.knowledgeSearchQuery="")},selectDefaultQuestion(s){this.inputMessage=s,this.sendMessage(),this.showDefaultQuestions=!1},initSocket(){try{this.socket&&(console.log("Cleaning up existing socket connection"),this.socket.disconnect(),this.socket.removeAllListeners()),console.log("Connecting to socket server:",this.socketUrl);const s={reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,timeout:6e4};this.token&&(s.auth={token:this.token},console.log("Using token for authentication:",this.token)),this.socket=M(this.socketUrl,s),this.socket.on("connect",()=>{console.log("Connected to socket server, socket id:",this.socket.id),this.connectionStatus="متصل شد",this.connectionColor="green",this.sessionData.id&&(console.log("Reregistering existing session:",this.sessionData.id),this.socket.emit("register_session",{sessionId:this.sessionData.id,userId:this.userId}))}),this.socket.on("disconnect",e=>{console.log("Disconnected from socket server. Reason:",e),this.connectionStatus="قطع شد",this.connectionColor="red",this.sessionData.initialized=!1}),this.socket.on("connect_error",e=>{console.error("Socket connection error:",e),this.connectionStatus="خطای اتصال",this.connectionColor="red"}),this.socket.on("session_created",e=>{console.log("Session created:",e),this.sessionData.id=e.sessionId,this.sessionData.initialized=!0,localStorage.setItem("lastSessionId",e.sessionId),this.connectionStatus="آماده گفتگو",this.connectionColor="green"}),this.socket.on("bot_response",e=>{console.log("Received bot_response:",e),this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=null),this.handleResponseData(e)}),this.socket.on("message",e=>{console.log("Received message event:",e),this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=null),this.handleResponseData(e)}),this.socket.on("assistant_message",e=>{console.log("Received assistant_message event:",e),this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=null),this.handleResponseData(e)}),this.socket.on("complete",e=>{if(console.log("Received complete event:",e),this.currentStreamingMessage){if(console.log("Finalizing message"),this.currentStreamingMessage.content.includes("![")){const t=this.processMessageWithImages(this.currentStreamingMessage.content);this.currentStreamingMessage.content=t}this.currentStreamingMessage.content=this.currentStreamingMessage.content.replace(/\n/g,"<br>"),this.currentStreamingMessage.isStreaming=!1,this.currentStreamingMessage.isComplete=!0,setTimeout(()=>{this.currentStreamingMessage&&(this.currentStreamingMessage.isComplete=!1)},300),this.saveMessagesToLocalStorage(),this.currentStreamingMessage=null,this.scrollToBottom()}e&&e.message&&!this.messages.some(t=>t.content===e.message)&&(console.log("Creating new complete message"),this.addBotMessage(e.message))}),this.socket.on("error",e=>{console.error("Socket error:",e),this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=null),this.isThinking=!1,this.messages.push({content:typeof e=="string"?e:e.message||"خطای ناشناخته",isUser:!1,isError:!0}),this.scrollToBottom()}),this.socket.onAny((e,...t)=>{console.log(`Socket event '${e}' received:`,t)})}catch(s){console.error("Error in initSocket:",s),this.connectionStatus="خطا در اتصال",this.messages.push({content:"خطا در اتصال به سرور: "+s.message,isUser:!1,isError:!0})}},startConversationWithDefaultQuestion(){this.isOpen=!0,this.hasInteracted=!0,localStorage.setItem("vafachat_interacted","true"),this.currentTab="messenger",this.inputMessage=this.defaultQuestion,this.$nextTick(()=>{this.sendMessage()})},toggleChat(){this.isOpen=!this.isOpen,this.hasInteracted=!0,localStorage.setItem("vafachat_interacted","true"),this.isOpen&&this.$nextTick(()=>{const s=document.getElementById("vafachat-input");s&&s.focus()})},closeChat(){this.isOpen=!1,this.isMaximize=!1},sendMessage(){if(this.inputMessage.trim()==="")return;this.hasInteracted||(this.hasInteracted=!0,localStorage.setItem("vafachat_interacted","true"),this.resetShakeTimer()),this.showDefaultQuestions=!1;const s=this.inputMessage.trim();this.inputMessage="",this.currentStreamingMessage&&(this.currentStreamingMessage.isStreaming=!1,this.currentStreamingMessage=null),this.messages.push({content:s,isUser:!0,timestamp:new Date().toISOString()}),this.saveMessagesToLocalStorage(),this.isThinking=!0,this.scrollToBottom(),this.socket&&this.socket.connected?(console.log("Sending message to server:",{userId:this.userId,sessionId:this.sessionData.id||null,message:s}),this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageTimeout=setTimeout(()=>{this.isThinking&&(console.warn("No response received from server within timeout"),this.isThinking=!1,this.messages.push({content:"پاسخی از سرور دریافت نشد. لطفاً مجدداً تلاش کنید.",isUser:!1,isError:!0}),this.scrollToBottom())},3e4),this.socket.emit("chat message",{userId:this.userId,sessionId:this.sessionData.id||null,message:s}),this.socket.emit("send_message",{userId:this.userId,sessionId:this.sessionData.id||null,message:s})):(console.error("Socket not connected. Cannot send message."),this.isThinking=!1,this.messages.push({content:"ارتباط با سرور قطع شده است. در حال تلاش برای اتصال مجدد...",isUser:!1,isError:!0}),this.initSocket())},scrollToBottom(){this.$nextTick(()=>{this.$refs.chatBody&&(this.$refs.chatBody.scrollTop=this.$refs.chatBody.scrollHeight)})},handleResponseData(s){if(console.log("Processing data:",s),s.type==="thinking"){this.isThinking=!0;return}else this.isThinking=!1;if(typeof s=="string"){this.addBotMessage(s);return}if(s){if(s.type==="chunk"&&s.message){console.log("Adding chunk:",s.message);const e=this.messages[this.messages.length-1];e&&e.isUser&&(this.currentStreamingMessage=null),this.addBotMessageChunk(s.message);return}if(s.type==="complete"){console.log("Message complete");return}if(s.content){if(Array.isArray(s.content)){const e=s.content.filter(t=>t.type==="text"&&t.text&&t.text.value).map(t=>t.text.value).join(`
`);e&&this.addBotMessage(e)}else typeof s.content=="object"&&s.content.text?this.addBotMessage(s.content.text.value||s.content.text):this.addBotMessage(s.content);return}if(s.message){this.addBotMessage(s.message);return}if(s.text){this.addBotMessage(s.text);return}}},addBotMessage(s){if(!s)return;let e=s.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");const t=/!\[(.*?)\]\((http[s]?:\/\/.*?)\)/g;e=e.replace(t,'<br><img src="$2" alt="$1" style="max-width:100%; display:block; margin:10px 0; border-radius:8px;">'),this.messages.push({content:e,isUser:!1,isImage:e.includes("<img"),timestamp:new Date().toISOString()}),this.scrollToBottom()},addBotMessageChunk(s){let e=-1;for(let r=this.messages.length-1;r>=0;r--)if(this.messages[r].isUser){e=r;break}(!this.currentStreamingMessage||e>-1&&this.messages.indexOf(this.currentStreamingMessage)<e)&&(this.currentStreamingMessage&&(this.currentStreamingMessage.isStreaming=!1),this.currentStreamingMessage={content:"",isUser:!1,isImage:!1,timestamp:new Date().toISOString(),isStreaming:!0},this.messages.push(this.currentStreamingMessage));const i=s.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(this.currentStreamingMessage.content+=i,this.saveMessagesToLocalStorage(),this.$forceUpdate(),this.scrollToBottom(),this.currentStreamingMessage.content.includes("![")&&this.currentStreamingMessage.content.includes("](")&&this.currentStreamingMessage.content.includes(")")){const r=this.processMessageWithImages(this.currentStreamingMessage.content);this.currentStreamingMessage.content=r}this.$nextTick(()=>{this.scrollToBottom()})},addErrorMessage(s){this.messages.push({content:s,isUser:!1,isError:!0}),this.scrollToBottom()},processMessageWithImages(s){if(!s)return"";console.log("Processing message for images:",s);try{let e=s,t;const i=/!\[(.*?)\]\((http[s]?:\/\/[^\s)]+)\)/g;for(;(t=i.exec(s))!==null;){const r=t[0],o=t[1],c=t[2];console.log(`Found image: ${c} with alt text: ${o}`);const a=`__IMAGE_PLACEHOLDER_${Math.random().toString(36).substring(2,15)}__`;e=e.replace(r,a);const h=`<div class="message-image-container"><img src="${c}" alt="${o}" class="message-image" style="max-width:100%;height:auto;display:block;margin:10px auto;"></div>`;e=e.replace(a,h)}return console.log("Processed message:",e),e}catch(e){return console.error("Error processing images:",e),s}},setShakeTimer(){this.shakeTimer&&clearTimeout(this.shakeTimer),this.shakeTimer=setTimeout(()=>{if(!this.hasInteracted&&!this.isOpen){const s=document.getElementById("vafachat-button");s&&(s.style.animation="none",s.offsetHeight,s.style.animation=null,this.hasInteracted=!1)}},12e4)},resetShakeTimer(){this.setShakeTimer()},saveMessagesToLocalStorage(){if(this.userId)try{const s=this.messages.map(e=>({content:e.content,isUser:e.isUser,isImage:e.isImage||!1,timestamp:e.timestamp||new Date().toISOString()}));localStorage.setItem(`vafachat_messages_${this.userId}`,JSON.stringify(s)),console.log("Chat history saved to localStorage")}catch(s){console.error("Error saving chat history:",s)}},loadMessagesFromLocalStorage(){if(this.userId)try{const s=localStorage.getItem(`vafachat_messages_${this.userId}`);if(s){const e=JSON.parse(s);Array.isArray(e)&&e.length>0&&(this.messages=e,console.log(`Loaded ${e.length} messages from localStorage`),this.$nextTick(()=>{this.scrollToBottom()}))}}catch(s){console.error("Error loading chat history:",s)}}}},ft={class:"v-fixed v-flex v-flex-col v-gap-2 v-right-[20px] v-bottom-[20px]"},ut={key:0,class:"v-py-4 v-px-3 v-bg-white v-text-slate-800 v-flex v-items-center v-relative v-flex-row v-border-b v-border-slate-200"},pt={class:"v-flex v-justify-between v-items-center v-flex-1 v-gap-2"},gt={class:"v-flex v-grow v-flex-col v-gap-[2px]"},mt={class:"v-text-xs"},vt={class:"v-flex v-gap-2"},yt={key:0,viewBox:"0 0 512 512",fill:"currentColor",width:"16px",height:"16px"},wt={key:1,viewBox:"0 0 512 512",fill:"currentColor",width:"16px",height:"16px"},kt={key:1,class:"v-py-4 v-px-3 v-bg-[#1a237e] v-text-white v-flex v-items-center v-relative v-flex-row"},xt={class:"v-flex v-justify-between v-items-center v-flex-1 v-gap-2"},bt={class:"v-flex v-grow v-flex-col v-gap-[2px]"},_t={class:"v-text-xs"},Et={class:"v-flex v-gap-2"},Tt={key:2,class:"v-py-4 v-px-3 v-bg-white v-text-slate-800 v-flex v-items-center v-relative v-flex-row v-border-b v-border-slate-200"},St={key:1,class:"v-p-2 v-rounded-lg v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center"},Ct={key:3,class:"v-relative v-flex v-flex-col v-h-full v-justify-between v-bg-gradient-to-b v-from-[#1a237e] v-to-white"},Bt={class:"v-px-3"},Nt={class:"v-text-lg v-mb-4 v-text-white"},Lt={class:"v-p-2 v-rounded-lg v-border-1 v-border-slate-200 v-bg-white v-flex v-flex-col v-gap-[2px]"},Vt=["onClick"],Mt={class:"v-flex-1 v-text-sm v-text-slate-800 v-overflow-hidden v-whitespace-nowrap v-truncate"},At={class:"v-px-3 v-pb-4"},Ot={key:4,class:"v-relative v-flex v-flex-col v-h-full v-justify-between v-bg-white v-py-2 v-px-3 v-overflow-auto",ref:"chatBody"},Rt={class:"v-grow"},It=["innerHTML"],Dt={key:0,class:"vafachat-message vafachat-bot-message",style:{"font-style":"italic",opacity:"0.8"}},qt={key:0,class:"v-flex v-flex-col v-gap-2"},zt=["onClick"],Pt={key:5,class:"v-relative v-flex v-h-full v-overflow-hidden v-p-0 v-justify-start v-flex-col v-items-stretch"},Ut={class:"v-py-2 v-px-3 v-border-b v-border-slate-200 v-bg-white"},Qt={class:"v-flex v-items-center v-justify-between v-rounded-lg v-bg-slate-100"},Ft={key:0,class:"v-relative v-flex v-flex-col v-h-full v-bg-white v-overflow-auto"},Kt={class:"v-py-2 v-px-3 v-border-b v-border-slate-200"},jt={class:"v-text-md v-text-slate-800 v-font-semibold"},Ht=["onClick"],Wt={class:"v-flex-1 v-flex v-flex-col v-gap-1"},Yt={class:"v-text-sm v-text-slate-800 v-font-semibold"},Jt={class:"v-text-sm v-text-slate-800"},Xt={class:"v-text-sm v-text-slate-600"},Gt={key:1,class:"v-bg-white v-flex v-flex-col v-grow v-overflow-auto"},Zt={class:"v-py-2 v-px-3 v-border-b v-border-slate-200 v-gap-1 v-flex v-flex-col"},$t={class:"v-text-sm v-text-slate-800 v-font-semibold"},es={class:"v-text-sm v-text-slate-800"},ts={class:"v-text-sm v-text-slate-600"},ss=["onClick"],is={class:"v-text-sm v-text-slate-800"},ns={key:2,class:"v-bg-white v-flex v-flex-col v-grow v-overflow-auto"},rs={class:"v-py-2 v-px-3 v-border-b v-border-slate-200 v-text-sm v-text-slate-800 v-font-semibold"},os={class:"v-py-2 v-px-3 v-text-sm v-text-slate-800"},cs={key:6,class:"v-py-2 v-px-3 v-bg-white v-border-t v-border-slate-200"},as={class:"v-flex v-items-center v-bg-white v-rounded-full v-border v-border-slate-200"},ls={key:7,class:"v-flex v-justify-around v-items-center v-gap-2 v-bg-white v-py-2 v-h-[60px] v-border-t v-border-slate-200"},hs={key:0,viewBox:"0 0 576 512",fill:"currentColor",width:"20px",height:"20px"},ds={key:1,viewBox:"0 0 576 512",fill:"currentColor",width:"20px",height:"20px"},fs={key:0,viewBox:"0 0 512 512",fill:"currentColor",width:"20px",height:"20px"},us={key:1,viewBox:"0 0 512 512",fill:"currentColor",width:"20px",height:"20px"},ps={key:0,viewBox:"0 0 448 512",fill:"currentColor",width:"20px",height:"20px"},gs={key:1,viewBox:"0 0 448 512",fill:"currentColor",width:"20px",height:"20px"};function ms(s,e,t,i,r,o){return n.openBlock(),n.createElementBlock("div",ft,[n.createElementVNode("div",{class:"v-border v-border-slate-200 v-rounded-lg v-rounded-br-sm v-py-2 v-px-3 v-text-sm v-cursor-pointer v-w-fit v-hover:bg-slate-100 v-transition-colors v-duration-300",onClick:e[0]||(e[0]=(...c)=>o.startConversationWithDefaultQuestion&&o.startConversationWithDefaultQuestion(...c))},n.toDisplayString(t.defaultQuestion),1),n.createElementVNode("div",{class:n.normalizeClass(["v-flex v-bg-[#1a237e] v-items-center v-justify-center v-rounded-full v-h-[60px] v-w-[60px] v-z-70 no-shake v-overflow-hidden v-cursor-pointer",{"no-shake":r.hasInteracted}]),onClick:e[1]||(e[1]=(...c)=>o.toggleChat&&o.toggleChat(...c))},e[20]||(e[20]=[n.createElementVNode("img",{src:"https://vafaai.com/widget/images/logo.svg",alt:"Chat",class:"v-h-[36px]"},null,-1)]),2),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(["v-fixed v-transition-all v-duration-300 v-right-[20px] v-bottom-[20px] v-rounded-md v-overflow-hidden v-z-90 v-flex v-flex-col v-shadow-[0_10px_25px_rgba(0,0,0,0.2)]",{"v-max-h-[calc(100%-104px)] v-h-[calc(100%-104px)] v-w-[688px]":r.isMaximize,"v-w-[400px] v-h-[700px] v-max-h-[min(714px,100%-30px)]":!r.isMaximize,"v-right-0 v-bottom-0 v-top-0 v-rounded-none v-h-full v-max-h-100vh v-w-full":r.isMobile}])},[r.currentTab==="messenger"?(n.openBlock(),n.createElementBlock("div",ut,[n.createElementVNode("div",pt,[r.currentTab!=="home"?(n.openBlock(),n.createElementBlock("div",{key:0,class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#2222220f] v-transition-colors v-duration-300",onClick:e[2]||(e[2]=c=>o.switchTab("home"))},e[21]||(e[21]=[n.createElementVNode("svg",{viewBox:"0 0 320 512",fill:"currentColor",width:"16px",height:"16px"},[n.createElementVNode("path",{d:"M273 239c9.4 9.4 9.4 24.6 0 33.9L113 433c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l143-143L79 113c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0L273 239z"})],-1)]))):n.createCommentVNode("",!0),e[23]||(e[23]=n.createElementVNode("img",{src:pe,alt:"Support Profile",class:"v-w-[32px] v-h-[32px]"},null,-1)),n.createElementVNode("div",gt,[e[22]||(e[22]=n.createElementVNode("div",{class:"v-text-sm v-font-semibold"},"پشتیبانی هوشمند ما",-1)),n.createElementVNode("div",mt,n.toDisplayString(r.connectionStatus),1)])]),n.createElementVNode("div",vt,[r.isMobile?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#2222220f] v-transition-colors v-duration-300",onClick:e[3]||(e[3]=c=>r.isMaximize=!r.isMaximize)},[r.isMaximize?(n.openBlock(),n.createElementBlock("svg",yt,e[24]||(e[24]=[n.createElementVNode("path",{d:"M489 57c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-135 135L320 72c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 144c0 13.3 10.7 24 24 24l144 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-86.1 0L489 57zM23 455c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l135-135 0 86.1c0 13.3 10.7 24 24 24s24-10.7 24-24l0-144c0-13.3-10.7-24-24-24L72 272c-13.3 0-24 10.7-24 24s10.7 24 24 24l86.1 0L23 455z"},null,-1)]))):(n.openBlock(),n.createElementBlock("svg",wt,e[25]||(e[25]=[n.createElementVNode("path",{d:"M295 183c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l135-135 0 86.1c0 13.3 10.7 24 24 24s24-10.7 24-24l0-144c0-13.3-10.7-24-24-24L344 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l86.1 0L295 183zM217 329c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L48 430.1 48 344c0-13.3-10.7-24-24-24s-24 10.7-24 24L0 488c0 13.3 10.7 24 24 24l144 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-86.1 0L217 329z"},null,-1)])))])),n.createElementVNode("div",{class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#2222220f] v-transition-colors v-duration-300",onClick:e[4]||(e[4]=(...c)=>o.closeChat&&o.closeChat(...c))},e[26]||(e[26]=[n.createElementVNode("svg",{viewBox:"0 0 384 512",fill:"currentColor",width:"18px",height:"18px"},[n.createElementVNode("path",{d:"M345 137c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-119 119L73 103c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l119 119L39 375c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l119-119L311 409c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-119-119L345 137z"})],-1)]))])])):n.createCommentVNode("",!0),r.currentTab==="home"?(n.openBlock(),n.createElementBlock("div",kt,[n.createElementVNode("div",xt,[e[28]||(e[28]=n.createElementVNode("img",{src:pe,alt:"Support Profile",class:"v-w-[32px] v-h-[32px]"},null,-1)),n.createElementVNode("div",bt,[e[27]||(e[27]=n.createElementVNode("div",{class:"v-text-sm v-font-semibold"},"پشتیبانی هوشمند وفا",-1)),n.createElementVNode("div",_t,n.toDisplayString(r.connectionStatus),1)])]),n.createElementVNode("div",Et,[n.createElementVNode("div",{class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-white v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#22222240] v-transition-colors v-duration-300",onClick:e[5]||(e[5]=(...c)=>o.closeChat&&o.closeChat(...c))},e[29]||(e[29]=[n.createElementVNode("svg",{viewBox:"0 0 384 512",fill:"currentColor",width:"16px",height:"16px"},[n.createElementVNode("path",{d:"M345 137c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-119 119L73 103c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l119 119L39 375c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l119-119L311 409c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-119-119L345 137z"})],-1)]))])])):n.createCommentVNode("",!0),r.currentTab==="knowledge"?(n.openBlock(),n.createElementBlock("div",Tt,[r.knowledgeView!=="categories"?(n.openBlock(),n.createElementBlock("div",{key:0,class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#2222220f] v-transition-colors v-duration-300",onClick:e[6]||(e[6]=(...c)=>o.goBackKnowledge&&o.goBackKnowledge(...c))},e[30]||(e[30]=[n.createElementVNode("svg",{"data-v-8cc45828":"",viewBox:"0 0 320 512",fill:"currentColor",width:"16px",height:"16px"},[n.createElementVNode("path",{"data-v-8cc45828":"",d:"M273 239c9.4 9.4 9.4 24.6 0 33.9L113 433c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l143-143L79 113c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0L273 239z"})],-1)]))):(n.openBlock(),n.createElementBlock("div",St)),e[32]||(e[32]=n.createElementVNode("div",{class:"v-text-sm v-text-center v-font-semibold v-flex-1"},"پایگاه دانش",-1)),n.createElementVNode("div",{class:"v-p-2 v-rounded-lg v-cursor-pointer v-text-slate-800 v-w-[36px] v-h-[36px] v-flex v-justify-center v-items-center v-hover:bg-[#2222220f] v-transition-colors v-duration-300",onClick:e[7]||(e[7]=(...c)=>o.closeChat&&o.closeChat(...c))},e[31]||(e[31]=[n.createElementVNode("svg",{viewBox:"0 0 384 512",fill:"currentColor",width:"16px",height:"16px"},[n.createElementVNode("path",{d:"M345 137c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-119 119L73 103c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l119 119L39 375c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l119-119L311 409c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-119-119L345 137z"})],-1)]))])):n.createCommentVNode("",!0),r.currentTab==="home"?(n.openBlock(),n.createElementBlock("div",Ct,[n.createElementVNode("div",Bt,[n.createElementVNode("div",Nt,n.toDisplayString(t.welcomeTitle),1),n.createElementVNode("div",Lt,[n.createElementVNode("div",{class:"v-flex v-items-center v-justify-between v-rounded-lg v-mb-[6px] v-bg-slate-100",onClick:e[10]||(e[10]=(...c)=>o.focusOnSearch&&o.focusOnSearch(...c))},[n.withDirectives(n.createElementVNode("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=c=>r.knowledgeSearchQuery=c),ref:"homeSearchInput",onFocus:e[9]||(e[9]=(...c)=>o.showKnowledgeSearch&&o.showKnowledgeSearch(...c)),placeholder:"جست و جو کنید",class:"v-flex-1 v-border-0 v-outline-0 v-bg-transparent v-text-sm v-py-2 v-px-3"},null,544),[[n.vModelText,r.knowledgeSearchQuery]]),e[33]||(e[33]=n.createElementVNode("svg",{viewBox:"0 0 512 512",fill:"currentColor",width:"16px",height:"16px",class:"v-ml-3"},[n.createElementVNode("path",{d:"M368 208A160 160 0 1 0 48 208a160 160 0 1 0 320 0zM337.1 371.1C301.7 399.2 256.8 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 48.8-16.8 93.7-44.9 129.1L505 471c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L337.1 371.1z"})],-1))]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.featuredQuestions,c=>(n.openBlock(),n.createElementBlock("div",{key:c.id,class:"v-flex v-items-center v-justify-between v-py-2 v-px-3 v-bg-white v-cursor-pointer v-rounded-lg v-hover:bg-slate-100",onClick:a=>o.navigateToQuestion(c.id)},[n.createElementVNode("div",Mt,n.toDisplayString(c.question),1),e[34]||(e[34]=n.createElementVNode("svg",{viewBox:"0 0 320 512",fill:"currentColor",width:"14px",height:"14px"},[n.createElementVNode("path",{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"})],-1))],8,Vt))),128))])]),n.createElementVNode("div",At,[n.createElementVNode("div",{class:"v-bg-[#1a237e] v-text-white v-text-md v-rounded-lg v-py-3 v-px-6 v-flex v-items-center v-justify-between v-w-full v-cursor-pointer v-transition-colors v-duration-300",onClick:e[11]||(e[11]=c=>o.switchTab("messenger"))},e[35]||(e[35]=[n.createStaticVNode('<svg viewBox="0 0 512 512" fill="currentColor" width="24px" height="24px" data-v-2afe4a7e><path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm177.6 62.1C192.8 334.5 218.8 352 256 352s63.2-17.5 78.4-33.9c9-9.7 24.2-10.4 33.9-1.4s10.4 24.2 1.4 33.9c-22 23.8-60 49.4-113.6 49.4s-91.7-25.5-113.6-49.4c-9-9.7-8.4-24.9 1.4-33.9s24.9-8.4 33.9 1.4zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm165.8 21.7c-7.6 8.1-20.2 8.5-28.3 .9s-8.5-20.2-.9-28.3c14.5-15.5 35.2-22.3 54.6-22.3s40.1 6.8 54.6 22.3c7.6 8.1 7.1 20.7-.9 28.3s-20.7 7.1-28.3-.9c-5.5-5.8-14.8-9.7-25.4-9.7s-19.9 3.8-25.4 9.7z" data-v-2afe4a7e></path></svg><div class="v-text-md v-font-bold" data-v-2afe4a7e>شروع گفتگو</div><svg viewBox="0 0 320 512" fill="currentColor" width="16px" height="16px" data-v-2afe4a7e><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" data-v-2afe4a7e></path></svg>',3)]))])])):n.createCommentVNode("",!0),r.currentTab==="messenger"?(n.openBlock(),n.createElementBlock("div",Ot,[n.createElementVNode("div",Rt,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.messages,(c,a)=>(n.openBlock(),n.createElementBlock("div",{key:a,class:n.normalizeClass(["v-max-w-[80%] v-rounded-xl v-mb-2 v-text-sm v-py-2 v-px-3",c.isUser?"v-bg-[#1a237e] v-text-white v-rounded-br-sm v-justify-self-start":"v-bg-slate-100 v-text-slate-800 v-rounded-bl-sm v-justify-self-end",c.isStreaming?"v-streaming":"",c.isComplete?"v-completed":""])},[n.createElementVNode("div",{innerHTML:c.content},null,8,It)],2))),128)),r.isThinking?(n.openBlock(),n.createElementBlock("div",Dt," در حال تایپ... ")):n.createCommentVNode("",!0)]),r.showDefaultQuestions&&r.currentTab==="messenger"?(n.openBlock(),n.createElementBlock("div",qt,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.defaultQuestions,(c,a)=>(n.openBlock(),n.createElementBlock("div",{key:a,class:"v-border v-border-slate-200 v-rounded-full v-py-2 v-px-3 v-text-sm v-cursor-pointer v-w-fit v-hover:bg-slate-100 v-transition-colors v-duration-300",onClick:h=>o.selectDefaultQuestion(c)},n.toDisplayString(c),9,zt))),128))])):n.createCommentVNode("",!0)],512)):n.createCommentVNode("",!0),r.currentTab==="knowledge"?(n.openBlock(),n.createElementBlock("div",Pt,[n.createElementVNode("div",Ut,[n.createElementVNode("div",Qt,[n.withDirectives(n.createElementVNode("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=c=>r.knowledgeSearchQuery=c),onInput:e[13]||(e[13]=(...c)=>o.searchKnowledgeBase&&o.searchKnowledgeBase(...c)),placeholder:"جست و جو کنید",class:"v-flex-1 v-border-0 v-outline-0 v-bg-transparent v-text-sm v-py-2 v-px-3"},null,544),[[n.vModelText,r.knowledgeSearchQuery]]),e[36]||(e[36]=n.createElementVNode("svg",{viewBox:"0 0 512 512",fill:"currentColor",width:"16px",height:"16px",class:"v-ml-3"},[n.createElementVNode("path",{d:"M368 208A160 160 0 1 0 48 208a160 160 0 1 0 320 0zM337.1 371.1C301.7 399.2 256.8 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 48.8-16.8 93.7-44.9 129.1L505 471c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L337.1 371.1z"})],-1))])]),r.knowledgeView==="categories"?(n.openBlock(),n.createElementBlock("div",Ft,[n.createElementVNode("div",Kt,[n.createElementVNode("div",jt,n.toDisplayString(o.filteredCategories.length)+" دسته بندی ",1)]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(o.filteredCategories,c=>(n.openBlock(),n.createElementBlock("div",{key:c.id,class:"v-flex v-items-center v-justify-between v-border-b v-border-slate-200 v-cursor-pointer v-px-3 v-py-2 v-gap-2 v-hover:bg-slate-100 v-transition-colors v-duration-300",onClick:a=>o.selectCategory(c)},[n.createElementVNode("div",Wt,[n.createElementVNode("div",Yt,n.toDisplayString(c.title),1),n.createElementVNode("div",Jt,n.toDisplayString(c.description),1),n.createElementVNode("div",Xt,n.toDisplayString(c.questions.length)+" پرسش ",1)]),e[37]||(e[37]=n.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16px",height:"16px",viewBox:"0 0 320 512",fill:"currentColor"},[n.createElementVNode("path",{d:"M15 239c-9.4 9.4-9.4 24.6 0 33.9L207 465c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L65.9 256 241 81c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L15 239z"})],-1))],8,Ht))),128))])):n.createCommentVNode("",!0),e[39]||(e[39]=n.createElementVNode("div",{class:"v-absolute v-pointer-events-none v-h-[36px] v-bottom-0 v-w-full v-bg-gradient-to-b v-from-transparent v-to-white"},null,-1)),r.knowledgeView==="questions"?(n.openBlock(),n.createElementBlock("div",Gt,[n.createElementVNode("div",Zt,[n.createElementVNode("div",$t,n.toDisplayString(r.selectedCategory.title),1),n.createElementVNode("div",es,n.toDisplayString(r.selectedCategory.description),1),n.createElementVNode("div",ts,n.toDisplayString(o.filteredQuestions.length)+" پرسش ",1)]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(o.filteredQuestions,c=>(n.openBlock(),n.createElementBlock("div",{key:c.id,class:"v-flex v-items-center v-justify-between v-py-3 v-px-3 v-border-b v-border-slate-200 v-cursor-pointer v-gap-2 v-hover:bg-slate-100 v-transition-colors v-duration-300",onClick:a=>o.selectQuestion(c)},[n.createElementVNode("div",is,n.toDisplayString(c.question),1),e[38]||(e[38]=n.createElementVNode("svg",{"data-v-8cc45828":"",xmlns:"http://www.w3.org/2000/svg",width:"16px",height:"16px",viewBox:"0 0 320 512",fill:"currentColor"},[n.createElementVNode("path",{"data-v-8cc45828":"",d:"M15 239c-9.4 9.4-9.4 24.6 0 33.9L207 465c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L65.9 256 241 81c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L15 239z"})],-1))],8,ss))),128))])):n.createCommentVNode("",!0),r.knowledgeView==="answer"?(n.openBlock(),n.createElementBlock("div",ns,[n.createElementVNode("div",rs,n.toDisplayString(r.selectedQuestion.question),1),n.createElementVNode("div",os,n.toDisplayString(r.selectedQuestion.answer),1)])):n.createCommentVNode("",!0)])):n.createCommentVNode("",!0),r.currentTab==="messenger"?(n.openBlock(),n.createElementBlock("div",cs,[n.createElementVNode("div",as,[n.withDirectives(n.createElementVNode("input",{type:"text","onUpdate:modelValue":e[14]||(e[14]=c=>r.inputMessage=c),onKeyup:e[15]||(e[15]=n.withKeys((...c)=>o.sendMessage&&o.sendMessage(...c),["enter"])),placeholder:"اینجا تایپ کنید ...",class:"v-flex-1 v-border-0 v-outline-0 v-bg-transparent v-text-sm v-py-2 v-px-3 v-rounded-full"},null,544),[[n.vModelText,r.inputMessage]]),(n.openBlock(),n.createElementBlock("svg",{viewBox:"0 0 512 512",fill:"currentColor",width:"20px",height:"20px",class:"v-ml-3 v-text-[#1a237e] v-rotate-180 v-cursor-pointer",onClick:e[16]||(e[16]=(...c)=>o.sendMessage&&o.sendMessage(...c))},e[40]||(e[40]=[n.createElementVNode("path",{d:"M133.9 232L65.8 95.9 383.4 232l-249.5 0zm0 48l249.5 0L65.8 416.1l68-136.1zM44.6 34.6C32.3 29.3 17.9 32.3 8.7 42S-2.6 66.3 3.4 78.3L92.2 256 3.4 433.7c-6 12-3.9 26.5 5.3 36.3s23.5 12.7 35.9 7.5l448-192c11.8-5 19.4-16.6 19.4-29.4s-7.6-24.4-19.4-29.4l-448-192z"},null,-1)])))]),e[41]||(e[41]=n.createElementVNode("div",{class:"v-text-center v-text-xs v-text-slate-600 v-pt-2"},"ساخته شده با وفا",-1))])):n.createCommentVNode("",!0),r.currentTab==="home"||r.currentTab==="knowledge"?(n.openBlock(),n.createElementBlock("div",ls,[n.createElementVNode("div",{class:n.normalizeClass(["v-flex v-flex-col v-flex-1 v-items-center v-justify-center v-cursor-pointer v-gap-2",{active:r.currentTab==="home","v-text-[#1a237e] v-font-semibold":r.currentTab==="home","v-text-slate-800":r.currentTab!=="home"}]),onClick:e[17]||(e[17]=c=>o.switchTab("home"))},[r.currentTab==="home"?(n.openBlock(),n.createElementBlock("svg",hs,e[42]||(e[42]=[n.createElementVNode("path",{d:"M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c.2 35.5-28.5 64.3-64 64.3H128.1c-35.3 0-64-28.7-64-64V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"},null,-1)]))):(n.openBlock(),n.createElementBlock("svg",ds,e[43]||(e[43]=[n.createElementVNode("path",{d:"M303.5 5.7c-9-7.6-22.1-7.6-31.1 0l-264 224c-10.1 8.6-11.3 23.7-2.8 33.8s23.7 11.3 33.8 2.8L64 245.5 64 432c0 44.2 35.8 80 80 80l288 0c44.2 0 80-35.8 80-80l0-186.5 24.5 20.8c10.1 8.6 25.3 7.3 33.8-2.8s7.3-25.3-2.8-33.8l-264-224zM464 204.8L464 432c0 17.7-14.3 32-32 32l-288 0c-17.7 0-32-14.3-32-32l0-227.2L288 55.5 464 204.8z"},null,-1)]))),e[44]||(e[44]=n.createElementVNode("div",{class:"v-text-xs"},"خانه",-1))],2),n.createElementVNode("div",{class:n.normalizeClass(["v-flex v-flex-col v-flex-1 v-items-center v-justify-center v-cursor-pointer v-gap-2",{active:r.currentTab==="messenger","v-text-[#1a237e] v-font-semibold":r.currentTab==="messenger","v-text-slate-800":r.currentTab!=="messenger"}]),onClick:e[18]||(e[18]=c=>o.switchTab("messenger"))},[r.currentTab==="messenger"?(n.openBlock(),n.createElementBlock("svg",fs,e[45]||(e[45]=[n.createElementVNode("path",{d:"M0 64C0 28.7 28.7 0 64 0L448 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-138.7 0L185.6 508.8c-4.8 3.6-11.3 4.2-16.8 1.5s-8.8-8.2-8.8-14.3l0-80-96 0c-35.3 0-64-28.7-64-64L0 64zm152 80c-13.3 0-24 10.7-24 24s10.7 24 24 24l208 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-208 0zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24l112 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-112 0z"},null,-1)]))):(n.openBlock(),n.createElementBlock("svg",us,e[46]||(e[46]=[n.createElementVNode("path",{d:"M208 416c0-26.5-21.5-48-48-48l-96 0c-8.8 0-16-7.2-16-16L48 64c0-8.8 7.2-16 16-16l384 0c8.8 0 16 7.2 16 16l0 288c0 8.8-7.2 16-16 16l-138.7 0c-10.4 0-20.5 3.4-28.8 9.6L208 432l0-16zm-.2 76.2l.2-.2 101.3-76L448 416c35.3 0 64-28.7 64-64l0-288c0-35.3-28.7-64-64-64L64 0C28.7 0 0 28.7 0 64L0 352c0 35.3 28.7 64 64 64l48 0 48 0 0 48 0 4 0 .3 0 6.4 0 21.3c0 6.1 3.4 11.6 8.8 14.3s11.9 2.1 16.8-1.5L202.7 496l5.1-3.8zM152 144c-13.3 0-24 10.7-24 24s10.7 24 24 24l208 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-208 0zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24l112 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-112 0z"},null,-1)]))),e[47]||(e[47]=n.createElementVNode("div",{class:"v-text-xs"},"پیام رسان",-1))],2),n.createElementVNode("div",{class:n.normalizeClass(["v-flex v-flex-col v-flex-1 v-items-center v-justify-center v-cursor-pointer v-gap-2",{active:r.currentTab==="knowledge","v-text-[#1a237e] v-font-semibold":r.currentTab==="knowledge","v-text-slate-800":r.currentTab!=="knowledge"}]),onClick:e[19]||(e[19]=c=>o.switchTab("knowledge"))},[r.currentTab==="knowledge"?(n.openBlock(),n.createElementBlock("svg",ps,e[48]||(e[48]=[n.createElementVNode("path",{d:"M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zm73.8 133.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L248 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM192 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"},null,-1)]))):(n.openBlock(),n.createElementBlock("svg",gs,e[49]||(e[49]=[n.createElementVNode("path",{d:"M64 80c-8.8 0-16 7.2-16 16l0 320c0 8.8 7.2 16 16 16l320 0c8.8 0 16-7.2 16-16l0-320c0-8.8-7.2-16-16-16L64 80zM0 96C0 60.7 28.7 32 64 32l320 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zm137.8 69.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L248 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM192 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"},null,-1)]))),e[50]||(e[50]=n.createElementVNode("div",{class:"v-text-xs"},"پایگاه دانش",-1))],2)])):n.createCommentVNode("",!0)],2),[[n.vShow,r.isOpen]])])}const W=ht(dt,[["render",ms],["__scopeId","data-v-2afe4a7e"]]);let Y={welcomeTitle:"به رستوران ما خوش آمدید",initialMessage:"سلام! چطور میتونم کمکتون کنم؟",defaultQuestion:"هاسکووب چیست؟",apiBaseUrl:"https://api.vafaai.com"};function J(s={}){return Y={...Y,...s},Y}function ge(s="#vafa-chat-widget",e={}){const t=J(e);let i=document.querySelector(s);i||(i=document.createElement("div"),i.id=s.replace("#",""),document.body.appendChild(i));const r=n.createApp(W,t);return r.mount(i),r}function me(s){s.component("VafaChatWidget",W)}const vs={install:me,configure:J,init:ge};p.ChatWidget=W,p.configure=J,p.default=vs,p.init=ge,p.install=me,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
